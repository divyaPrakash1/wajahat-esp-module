<xcdrs-activity-size-detector></xcdrs-activity-size-detector>
<div
  fxFlex
  fxShow.xs
  fxShow.sm
  fxShow.gt-md
  fxShow.lt-xl
  fxShow.lg
  fxShow.lt-lg
  fxShow.md
  fxLayout="column"
  fxLayoutAlign="start stretch"
  class="dialog-container"
  *ngIf="!isLoading"
>
  <div class="cross-div"
    fxFlex="nogrow"
    fxLayout="row"
    fxLayoutAlign="end center"
    fxHide.xs
    fxHide.sm
  >
    <mat-icon class="clickable cross" (click)="onNoClick()">close</mat-icon>
  </div>

  <div
    class="content"
    [ngClass]="{'xs': size =='XS', 'sm': size=='SM'}"
    fxLayout="column"
    fxLayoutAlign="start stretch"
  >
    <h1 mat-dialog-title class="title">{{'Connect-Systems' | translate}}</h1>

    <mat-card fxFlex fxLayout="column" fxLayoutAlign="start stretch" >
        <mat-card-title  fxFlex fxLayout="row" fxLayoutAlign="space-between center">
            <span class="title" (click)="linkToEpmAccount()" [ngClass]="{'clickable': !isEpmConnected , 'not-clickable':isEpmConnected}">{{'MS-Project-Online' | translate}}</span>
            <span class="status" fxFlex="nogrow"
            fxLayout="row"
            fxLayoutAlign="end center"
            [ngClass]="{'active': isEpmConnected}">
                <span *ngIf="!isEpmConnected">{{'Not' | translate}}&nbsp;</span>{{'Connected' | translate}}
                <button
                mat-icon-button
                [matMenuTriggerFor]="menu"
                *ngIf="isEpmConnected"
                (click)="$event.stopPropagation();"
              >
                <mat-icon>more_vert</mat-icon>
              </button>
              <mat-menu #menu="matMenu" class="disconnect-menu">
                <button
                  mat-menu-item
                  (click)="disconnectEpmAccount()"
                >
                 {{'Disconnect' | translate}}
                </button>
              </mat-menu>
        </span>
        </mat-card-title>
    </mat-card>
  </div>
</div>

<div
  *ngIf="isLoading"
  fxFlex
  fxLayout="column"
  fxLayoutAlign="space-around center"
  class="spinner-container"
>
  <mat-spinner></mat-spinner>
</div>
