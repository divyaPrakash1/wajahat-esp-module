<xcdrs-activity-size-detector></xcdrs-activity-size-detector>
<div
  fxFlex
  fxLayout="column"
  fxLayoutAlign="start stretch"
  *ngIf="isEngProDataLoaded && dataLoaded && !isLoading"
  class="followed-user-details-container"
>
  <div fxFlex>
    <xcdrs-breadcrumbs [hidden]="!activitiesByGroup">
      <a (click)="goToApplication()">{{ 'Activities' | translate }}</a>
      <a (click)="goToActivity()">{{ 'Activities' | translate }}</a>
      <a (click)="goToFollowing()">{{ 'Following' | translate }}</a>
      <span>{{ 'Shared-Activities' | translate }}</span>
    </xcdrs-breadcrumbs>
  </div>
 
  <div
    class="mine-activities-conatiner"
    fxLayout="column"
    fxLayoutAlign="start stretch"
    fxFlex
    *ngIf="dataLoaded && !isLoading"
  >
    <!-- start crad slider & srearch-->
    <div
      fxFlex
      fxLayout="row"
      fxLayoutAlign="start start"
      class="actions-container"
    >
      <div fxFlex fxLayout="row" fxLayoutAlign="start center">
        <xcdrs-search-field (search)="onSearch($event)"></xcdrs-search-field>
        <!-- *ngIf="isDefultFilterApplied" -->
        <div class="defult-filter"></div>
        <span
          class="filter-icon-container"
          (click)="openFiltersDialog()"
        >
          <!-- *ngIf="isDefultFilterApplied" -->
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
          >
            <g fill="none" fill-rule="evenodd">
              <path d="M0 0H24V24H0z" />
              <path
                fill="#AAADB8"
                d="M10.071 11.56c.17.183.263.422.263.669v7.276c0 .437.532.66.848.352l2.046-2.326c.274-.326.425-.487.425-.81v-4.49c0-.247.095-.486.262-.669l5.873-6.32c.44-.473.1-1.242-.55-1.242H4.748c-.65 0-.99.767-.549 1.243l5.872 6.317z"
              />
            </g>
          </svg>
          <!-- <svg
            *ngIf="!isDefultFilterApplied"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
          >
            <g fill="none" fill-rule="evenodd">
              <path d="M0 0H24V24H0z" />
              <path
                fill="#6cb33f"
                d="M10.071 11.56c.17.183.263.422.263.669v7.276c0 .437.532.66.848.352l2.046-2.326c.274-.326.425-.487.425-.81v-4.49c0-.247.095-.486.262-.669l5.873-6.32c.44-.473.1-1.242-.55-1.242H4.748c-.65 0-.99.767-.549 1.243l5.872 6.317z"
              />
            </g>
          </svg> -->
        </span>
      
      </div>
      <div fxFlex="nogrow"></div>
    </div>

    <div
      fxFlex
      fxLayout="row"
      fxLayoutAlign="start center"
    >

      <div
        fxFlex
        fxLayout="column"
        fxLayoutAlign="start stretch"
        class="ungrouped-container"
      >
        <!--start group table-->

        <xcdrs-activities-table
          fxFlex
          fxHide.xs
          fxHide.sm
          fxShow.gt-md
          fxShow.lt-xl
          fxShow.lg
          fxShow.lt-lg
          fxShow.md
          fxLayout="column"
          fxLayoutAlign="start stretch"
          *ngIf="activitiesByGroup.ungrouped.length > 0"
          [loggedInUserId]="loggedInUserId"
          [activeTab]="activeTab"
          [totalCount]="totalCount"
          [lastLoadedCount]="lastLoadedCount"
          (pageChange)="onPageChange($event, selectedFiltersIds)"
          [activities]="activitiesSubject.asObservable()"
          [oppProData]="null"
          [espAddon]="null"
          (reloadList)="reload($event)"
          [engProLoggedInUserId]="engProLoggedInUserId"
          [pageNo]="pageIndex-1"
        >
        </xcdrs-activities-table>
        <div
          fxShow.xs
          fxShow.sm
          fxHide.gt-md
          fxHide.lt-xl
          fxHide.lg
          fxHide.lt-lg
          fxHide.md
          fxFlex
          fxLayout="column"
          fxLayoutAlign="start stretch"
          *ngIf="activitiesByGroup.ungrouped.length > 0"
        >
          <mat-card
            *ngFor="let activity of activitiesByGroup.ungrouped"
            fxFlex
            fxLayout="column"
            fxLayoutAlign="space-around stretch"
          >
            <mat-card-header
              class="card-header"
              fxFlex
              fxLayout="column"
              fxLayoutAlign="space-around stretch"
            >
              <mat-card-title
                class="clickable"
                (click)="openActivityDetails(activity)"
              >
                {{ activity.description | textTruncate: 60 }}</mat-card-title
              >
            </mat-card-header>

            <mat-card-content
              fxFlex
              fxLayout="column"
              fxLayoutAlign="space-around stretch"
            >
              <p
                fxFlex
                fxLayout="row"
                fxLayoutAlign="start center"
                *ngIf="!!activity.createdBy"
              >
                <mat-label fxFlex="35">Shared By: </mat-label>
                <span>
                  {{
                    activity.createdBy.UserFirstName +
                      " " +
                      activity.createdBy.UserLastName
                  }}
                </span>
              </p>
              
              <p fxFlex fxLayout="row" fxLayoutAlign="start center">
                <mat-label fxFlex="35"
                  ><span *ngIf="activity.appType != 2">Due </span>Date:
                </mat-label>
                <span
                  *ngIf="activity.dueDateLabel == 'Overdue'"
                  class="over-due"
                  >{{ activity.dueDate }}</span
                >
                <span *ngIf="activity.dueDateLabel != 'Overdue'">{{
                  activity.dueDate
                }}</span>
              </p>

              <p fxFlex fxLayout="row" fxLayoutAlign="start center">
                <mat-label fxFlex="35"
                  >Claimed:
                </mat-label>
                <span
                  >{{ activity.totalClaims }} <span *ngIf="activity.maxClaims !=null">/ {{activity.maxClaims}}</span></span
                >
              </p>

              <p fxFlex fxLayout="row" fxLayoutAlign="start center">
                <mat-label fxFlex="35"
                  >Open:
                </mat-label>
                <span
                 class="started" >{{ activity.sharedStats.StartedCount + activity.sharedStats.NotStartedCount  }}</span
                >
              </p>

              <p fxFlex fxLayout="row" fxLayoutAlign="start center">
                <mat-label fxFlex="35"
                  >Closed:
                </mat-label>
                <span
                class="completed" >{{ activity.sharedStats.CompletedCount + activity.sharedStats.CancelledCount  }}</span
                >
              </p>
            </mat-card-content>
          </mat-card>
        </div>

        <div
          fxFlex
          fxLayout="column"
          fxLayoutAlign="start stretch"
          class="fill-bg"
          *ngIf="
            !isReloadingList &&
            !isLoading &&
            dataLoaded &&
            !isError &&
            activitiesByGroup.ungrouped.length === 0 &&
            !isSearchMode()
          "
        >
          <xcdrs-detailed-panel-placeholder
            [imagePath]="''"
            [title]="'No-Activities-Available' | translate"
            [subTitle]="'It-Seems-No-Activites-Shared-Yet' | translate"
          >
          </xcdrs-detailed-panel-placeholder>
        </div>

        <div
          fxFlex
          fxLayout="column"
          fxLayoutAlign="start stretch"
          class="fill-bg"
          *ngIf="
            !isReloadingList &&
            dataLoaded &&
            !isLoading &&
            isError &&
            activitiesByGroup.ungrouped.length == 0
          "
        >
          <xcdrs-detailed-panel-placeholder
            [imagePath]="'../../../../assets/images/ic_error.png'"
            [title]="'EMPTY-SCREEN.OOP-SOMETHING-WENT-WRONG' | translate"
            [subTitle]="'EMPTY-SCREEN.CHECK-YOUR-INTERNET-CONNECTION' | translate"
          >
          </xcdrs-detailed-panel-placeholder>
        </div>

        <div
          class="fill-bg"
          *ngIf="
            !isReloadingList &&
            dataLoaded &&
            !isLoading &&
            !isError &&
            activitiesByGroup.ungrouped.length === 0 &&
            isSearchMode()
          "
        >
          <xcdrs-detailed-panel-placeholder
            [imagePath]="'../../../../assets/images/news-item/no-items.svg'"
            [title]="'Activity-Not-Found' | translate"
            [subTitle]="'Maybe-Your-Search-Was-Too-Specific' | translate"
          >
          </xcdrs-detailed-panel-placeholder>
        </div>
        <!-- end group table-->
      </div>
    </div>

    <!-- end groups accordion-->

  </div>

  <div
    fxFlex
    fxLayout="column"
    *ngIf="isReloadingList || (!isReloadingList && !dataLoaded && isLoading)"
    fxLayoutAlign="space-around center"
    class="spinner-container"
  >
    <mat-spinner></mat-spinner>
  </div>
</div>

<div
  fxFlex
  fxLayout="column"
  *ngIf="
    !isEngProDataLoaded ||
    isReloadingList ||
    (!isReloadingList && !dataLoaded && isLoading)
  "
  fxLayoutAlign="space-around center"
  class="spinner-container"
>
  <mat-spinner></mat-spinner>
</div>
