<xcdrs-activity-size-detector></xcdrs-activity-size-detector>
  <div class="main-container">
    <div class="data-contanier">
      <div
        class="mine-activities-conatiner"
        fxLayout="column"
        fxLayoutAlign="start stretch"
        fxFlex
        *ngIf="dataLoaded && !isLoading"
      >
        <!-- start crad slider & srearch-->
    
        <div
          fxFlex
          fxLayout="row"
          fxLayoutAlign="start start"
          class="actions-container"
        >
          <div fxFlex fxLayout="row" fxLayoutAlign="start center">
            <xcdrs-search-field (search)="onSearch($event)"></xcdrs-search-field>
            <!-- *ngIf="isDefultFilterApplied" -->
            <div class="defult-filter" *ngIf="!isDefultFilterApplied"></div>
            <span class="filter-icon-container" (click)="openFiltersDialog()">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
              >
                <g fill="none" fill-rule="evenodd">
                  <path d="M0 0H24V24H0z" />
                  <path
                    fill="#AAADB8"
                    d="M10.071 11.56c.17.183.263.422.263.669v7.276c0 .437.532.66.848.352l2.046-2.326c.274-.326.425-.487.425-.81v-4.49c0-.247.095-.486.262-.669l5.873-6.32c.44-.473.1-1.242-.55-1.242H4.748c-.65 0-.99.767-.549 1.243l5.872 6.317z"
                  />
                </g>
              </svg>
              <!-- <svg
                *ngIf="!isDefultFilterApplied"
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
              >
                <g fill="none" fill-rule="evenodd">
                  <path d="M0 0H24V24H0z" />
                  <path
                    fill="#6cb33f"
                    d="M10.071 11.56c.17.183.263.422.263.669v7.276c0 .437.532.66.848.352l2.046-2.326c.274-.326.425-.487.425-.81v-4.49c0-.247.095-.486.262-.669l5.873-6.32c.44-.473.1-1.242-.55-1.242H4.748c-.65 0-.99.767-.549 1.243l5.872 6.317z"
                  />
                </g>
              </svg> -->
            </span>
    
            <span class="more-icon-container" *ngIf="!((SourceSystemId && !teamId) || (!SourceSystemId && teamId) || (SourceSystemId && teamId))">
              <button mat-icon-button [matMenuTriggerFor]="menu">
                <mat-icon>more_vert</mat-icon>
              </button>
              <mat-menu #menu="matMenu">
                <!-- <button
                  mat-menu-item
                  fxFlex
                  fxLayout="row"
                  fxLayoutAlign="space-between center"
                >
                  <mat-checkbox [(ngModel)]="showImportant"
                    >Show Important First</mat-checkbox
                  >
                  <span fxFlex="nogrow" class="material-icons">
                    flag
                  </span>
                </button> -->
                <button mat-menu-item class="disabled-item" disabled>
                  <span>{{'Grouping' | translate }}</span>
                </button>
                <button
                  mat-menu-item
                  (click)="applyGrouping(option)"
                  *ngFor="let option of groupByOptions"
                >
                  <mat-radio-group [(ngModel)]="groupByAppliedFilter">
                    <mat-radio-button
                      [checked]="groupByAppliedFilter == option.id"
                      [value]="option.id"
                      (change)="applyGrouping(option)"
                    >
                      {{ option.name | translate}}
                    </mat-radio-button>
                  </mat-radio-group>
                </button>
              </mat-menu>
            </span>
          </div>
    
          <div fxFlex="nogrow">
            <button
              fxFlex="nogrow"
              fxHide.xs
              fxHide.sm
              class="add-action-btn gradient-btn"
              mat-flat-button
              color="primary"
              type="submit"
              (click)="openCreateDialog('new')"
            >
              {{ 'Add-Backlog-Activity' | translate }}
            </button>
          </div>
        </div>
        <!-- <div
          class="filter-container"
          fxFlex
          fxLayout="row wrap"
          fxLayoutAlign="start start"
          *ngIf="selectedFilters.length > 0 && !isDefultFilterApplied"
        >
          <ul class="filter-list">
            <li class="filter-list-item" *ngFor="let filter of selectedFilters">
              {{ filter.name }}
              <svg
                (click)="onFilterClose(filter)"
                class="icon-close"
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                viewBox="0 0 24 24"
              >
                <g fill="none" fill-rule="evenodd">
                  <path d="M0 0L24 0 24 24 0 24z" />
                  <path
                    fill="white"
                    d="M12 10.236L6.764 5c-.196-.195-.512-.195-.708 0L5 6.056c-.195.196-.195.512 0 .708L10.236 12 5 17.236c-.195.196-.195.512 0 .708L6.056 19c.196.195.512.195.708 0L12 13.764 17.236 19c.196.195.512.195.708 0L19 17.944c.195-.196.195-.512 0-.708L13.764 12 19 6.764c.195-.196.195-.512 0-.708L17.944 5c-.196-.195-.512-.195-.708 0L12 10.236z"
                  />
                </g>
              </svg>
            </li>
            <li
              (click)="onClearFilterS()"
              class="clear-filter-item"
              *ngIf="selectedFilters.length"
            >
              Clear Filter
            </li>
          </ul>
        </div> -->
    
        <!-- end card slider & search-->
    
        <!--start groups accordion-->
        <div
          fxFlex
          fxLayout="column"
          fxLayoutAlign="start stretch"
          class="groups-container"
          *ngIf="groupByAppliedFilter != 0"
        >
          <div
            *ngIf="activitiesByGroup.groups.length > 0"
            fxFlex
            fxLayout="column"
            fxLayoutAlign="start stretch"
          >
          <xcdrs-activities-group
          *ngFor="let group of activitiesByGroup.groups; let i = index"
          [group]="group"
          [i]="i"
          [selectedFiltersIds]="selectedFiltersIds"
          [search]="search"
          [loggedInUserId]="loggedInUserId"
          [activeTab]="activeTab"
          [totalCount]="totalCount"
          [lastLoadedCount]="lastLoadedCount"
          [size]="size"
          [groupByAppliedFilter]="groupByAppliedFilter"
          (reloadList)="reload($event)"
          [engProLoggedInUserId]="engProLoggedInUserId"
          [isEngProEnabled]="isEngProEnabled"
          ></xcdrs-activities-group>
          </div>
          <div
            class="fill-bg"
            *ngIf="
              !isLoading &&
              !isError &&
              activitiesByGroup.groups.length === 0 &&
              !isSearchMode()
            "
          >
            <xcdrs-detailed-panel-placeholder
              [imagePath]="''"
              [title]="'No-Groups-Available' | translate"
              [subTitle]="'It-Seems-No-Activites-Belong-To-Any-Groups' | translate"
            >
            </xcdrs-detailed-panel-placeholder>
          </div>
          <div
            class="fill-bg"
            *ngIf="!isLoading && isError && activitiesByGroup.groups.length == 0"
          >
          
          <!-- [imagePath]="'./assets/images/ic_error.png'" -->
            <xcdrs-detailed-panel-placeholder
              [imagePath]="'../../../assets/images/ic_error.png'"
              [title]="'EMPTY-SCREEN.OOP-SOMETHING-WENT-WRONG' | translate"
              [subTitle]="'EMPTY-SCREEN.CHECK-YOUR-INTERNET-CONNECTION' | translate"
            >
            </xcdrs-detailed-panel-placeholder>
          </div>
        </div>
    
        <div
          fxFlex
          fxLayout="column"
          fxLayoutAlign="start stretch"
          class="ungrouped-container"
          *ngIf="groupByAppliedFilter == 0"
        >
          <!--start group table-->
    
          <xcdrs-activities-table
            fxFlex
            fxHide.xs
            fxHide.sm
            fxShow.gt-md
            fxShow.lt-xl
            fxShow.lg
            fxShow.lt-lg
            fxShow.md
            fxLayout="column"
            fxLayoutAlign="start stretch"
            *ngIf="activitiesByGroup.ungrouped.length > 0"
            (reloadList)="reload($event)"
            [engProLoggedInUserId]="engProLoggedInUserId"
            [loggedInUserId]="loggedInUserId"
            [activeTab]="activeTab"
            [totalCount]="totalCount"
            [lastLoadedCount]="lastLoadedCount"
            (pageChange)="onPageChange($event, selectedFiltersIds)"
            [activities]="activitiesSubject.asObservable()"
            [oppProData]="null"
            [espAddon]="espAddon"
            [pageNo]="pageIndex-1"
          >
          </xcdrs-activities-table>
          <div
            fxShow.xs
            fxShow.sm
            fxHide.gt-md
            fxHide.lt-xl
            fxHide.lg
            fxHide.lt-lg
            fxHide.md
            fxFlex
            fxLayout="column"
            fxLayoutAlign="start stretch"
            *ngIf="activitiesByGroup.ungrouped.length > 0"
          >
            <mat-card
              *ngFor="let activity of activitiesByGroup.ungrouped"
              fxFlex
              fxLayout="column"
              fxLayoutAlign="space-around stretch"
            >
              <mat-card-header
                class="card-header"
                fxFlex
                fxLayout="column"
                fxLayoutAlign="start stretch"
              >
                <mat-card-title
                  class="clickable"
                  (click)="openActivityDetails(activity)"
                  fxFlex
                  fxLayout="row"
                  fxLayoutAlign="start center"
                >
                  <div fxFlex>{{ activity.description | textTruncate: 60 }}</div>
                  <div
                    class="more-duedate-icon-container"
                    fxFlex="nogrow"
                    fxLayout="row"
                    fxLayoutAlign="end center"
                  >
                    <button
                      mat-icon-button
                      [matMenuTriggerFor]="menu"
                      (click)="$event.stopPropagation();"
                    >
                      <mat-icon>more_vert</mat-icon>
                    </button>
                    <mat-menu #menu="matMenu" class="schedule-menu">
                      <button
                        mat-menu-item
                        (click)="doBacklogAction('Today', activity)"
                      >
                        {{'Do-Today' | translate}}
                      </button>
    
                      <button
                        mat-menu-item
                        (click)="doBacklogAction('Schedule', activity)"
                        class="last"
                      >
                        {{ 'Schedule' | translate }}
                      </button>
                    </mat-menu>
                  </div>
                </mat-card-title>
              </mat-card-header>
              <mat-card-content
                fxFlex
                fxLayout="column"
                fxLayoutAlign="space-around stretch"
              >
                <p
                  fxFlex
                  fxLayout="row"
                  fxLayoutAlign="start center"
                  *ngIf="activity.parentBoardId != null"
                >
                  <mat-label fxFlex="35">Project: </mat-label>
                  <span> {{ activity.parentBoardName }} </span>
                </p>
                <p
                fxFlex
                fxLayout="row"
                fxLayoutAlign="start center"
                *ngIf="activity.appType == 4 && activity.requestNumber!=null"
              >
                <mat-label fxFlex="35">Request #: </mat-label>
                <span>
                  {{
                    activity.requestNumber
                  }}
                </span>
              </p>
              <p
                fxFlex
                fxLayout="row"
                fxLayoutAlign="start center"
                *ngIf="activity.appType == 4 && activity.requestName!=null"
              >
                <mat-label fxFlex="35">Request Name: </mat-label>
                <span>
                  {{
                    activity.requestName
                  }}
                </span>
              </p>
              </mat-card-content>
            </mat-card>
          </div>
    
          <div
          
            class="fill-bg"
            *ngIf="
              !isReloadingList &&
              !isLoading &&
              !isError &&
              activitiesByGroup.ungrouped.length === 0 &&
              !isSearchMode()
            "
          >
            <xcdrs-detailed-panel-placeholder
              [imagePath]="''"
              [title]="'No-Activities-Available' | translate"
              [subTitle]="'It-Seems-No-Backlog-Activites-Created-Yet' | translate"
            >
            </xcdrs-detailed-panel-placeholder>
          </div>
          <div
            class="fill-bg"
            *ngIf="
              !isReloadingList &&
              !isLoading &&
              isError &&
              activitiesByGroup.ungrouped.length == 0
            "
          >
            <xcdrs-detailed-panel-placeholder
            [imagePath]="'../../../assets/images/ic_error.png'"
              [title]="'EMPTY-SCREEN.OOP-SOMETHING-WENT-WRONG' | translate"
              [subTitle]="'EMPTY-SCREEN.CHECK-YOUR-INTERNET-CONNECTION' | translate"
            >
            </xcdrs-detailed-panel-placeholder>
          </div>
          <div
            class="fill-bg"
            style="height: 300px !important;"
            *ngIf="
              !isReloadingList &&
              !isLoading &&
              !isError &&
              activitiesByGroup.ungrouped.length == 0 &&
              isSearchMode()
            "
          >
            <xcdrs-detailed-panel-placeholder
              [imagePath]="'../../../assets/images/ic_no_result.png'"
              [title]="'Sorry-We-Could-Not-Find-Any-Aesult' | translate"
              [subTitle]="'Maybe-Your-Search-Was-Too-Specific' | translate"
            >
            </xcdrs-detailed-panel-placeholder>
          </div>
          <!-- end group table-->
        </div>
    
        <div
          fxFlex
          fxShow.xs
          fxShow.sm
          fxHide.gt-md
          fxHide.lt-xl
          fxHide.lg
          fxHide.lt-lg
          fxHide.md
          fxLayout="column"
          fxLayoutAlign="space-around end"
          class="fab-container"
        >
          <button
            mat-fab
            color="primary"
            aria-label="create fab"
            fxFlex="nogrow"
            class="gradient-btn"
            type="submit"
            (click)="openCreateDialog('new')"
          >
            <mat-icon>add</mat-icon>
          </button>
        </div>
        <!-- end groups accordion-->
      </div>
    </div>
  <div class="spinner-main-container" *ngIf="isReloadingList || (!isReloadingList && !dataLoaded && isLoading)">
    <div
      fxFlex
      fxLayout="column"
      fxLayoutAlign="space-around center"
      class="spinner-container"
    >
      <mat-spinner></mat-spinner>
    </div>
  </div>
</div>
